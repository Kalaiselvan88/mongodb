{
    "docs": [
        {
            "location": "/", 
            "text": "MongoDB suite for Drupal 8\n\n\nThe MongoDB\n suite for Drupal\n 8 is a set of modules enabling the\nstorage of various types of data on a Drupal site, in addition to, or as a\nreplacement for the standard SQL storage used by Drupal.\n\n\nIt comprises several Drupal modules, each implementing a specific functionality.\nWith the exception of the base \"driver\" \nmongodb\n module, upon which all others\ndepend because it provides the standardized connection service to Drupal, all\nthe modules are independent of each other except where indicated.\n\n\nThe \nmongodb\n module is not just the basis for this package, but also is\ndesigned to ease the development of bespoke code for end-user projects,\nproviding Drupal-integrated Symfony services for Client and Database with a\nfamiliar alias-based selection, like the SQL database drivers do.\n\n\nModules\n\n\nWorking\n\n\n\n\n\n\n\n\nModule\n\n\nIn a word\n\n\nInformation\n\n\n\n\n\n\n\n\n\n\nmongodb\n\n\ndriver\n\n\nMongoDB Client and Database services, \ntests\n base\n\n\n\n\n\n\nmongodb_watchdog\n\n\nlogger\n\n\nPSR-3 compliant logger with a built-in UI\n\n\n\n\n\n\n\n\nNot yet ported\n\n\nThese modules exist for earlier Drupal versions, but have not been ported to\nDrupal 8 yet. Some of them might never be ported because they are no longer\nrelevant in Drupal 8\n\n\n\n\n\n\n\n\nModule\n\n\nInformation\n\n\n\n\n\n\n\n\n\n\nmongodb_block\n\n\nStore Drupal blocks in MongoDB\n\n\n\n\n\n\nmongodb_block_ui\n\n\nProvide a UI to manager blocks stored in MongoDB. Depends on \nmongodb_block\n.\n\n\n\n\n\n\nmongodb_cache\n\n\nStore cache information in MongoDB\n\n\n\n\n\n\nmongodb_field_storage\n\n\nStore entities and their fields in MongoDB\n\n\n\n\n\n\nmongodb_migrate\n\n\nMigrate SQL entities/fields to MongoDB. Depends on \nmongodb_field_storage\n.\n\n\n\n\n\n\nmongodb_queue\n\n\nImplement a MongoDB backend for Queue API\n\n\n\n\n\n\nmongodb_session\n\n\nStore session information in MongoDB\n\n\n\n\n\n\n\n\nPlanned\n\n\nThese modules have no direct equivalent in earlier versions, but their\ndevelopment is being considered.\n\n\n\n\n\n\n\n\nModule\n\n\nInformation\n\n\n\n\n\n\n\n\n\n\nmongodb_debug\n\n\nProvide low-level debug information. A D7 version exists on \nmongodb_logger\n but depends on the legacy \nmongo\n PHP extension. Futures versions will need the 1.4 version of the \nmongodb\n extension which implements the MongoDB APM specification.\n\n\n\n\n\n\n\n\nProject layout\n\n\nmkdocs.yml    # The configuration file.\ndocs/\n    index.md  # The documentation homepage.\n    ...       # Other markdown pages, images and other files.\n\n\n\nLegal information\n\n\n\n\nThis suite of modules is licensed under the General Public License, version 2 or later (GPL-2.0+).\n\n\nMongoDB is a registered trademark of MongoDB Inc.\n\n\nDrupal is a registered trademark of Dries Buytaert.", 
            "title": "Home"
        }, 
        {
            "location": "/#mongodb-suite-for-drupal-8", 
            "text": "The MongoDB  suite for Drupal  8 is a set of modules enabling the\nstorage of various types of data on a Drupal site, in addition to, or as a\nreplacement for the standard SQL storage used by Drupal.  It comprises several Drupal modules, each implementing a specific functionality.\nWith the exception of the base \"driver\"  mongodb  module, upon which all others\ndepend because it provides the standardized connection service to Drupal, all\nthe modules are independent of each other except where indicated.  The  mongodb  module is not just the basis for this package, but also is\ndesigned to ease the development of bespoke code for end-user projects,\nproviding Drupal-integrated Symfony services for Client and Database with a\nfamiliar alias-based selection, like the SQL database drivers do.", 
            "title": "MongoDB suite for Drupal 8"
        }, 
        {
            "location": "/#modules", 
            "text": "", 
            "title": "Modules"
        }, 
        {
            "location": "/#working", 
            "text": "Module  In a word  Information      mongodb  driver  MongoDB Client and Database services,  tests  base    mongodb_watchdog  logger  PSR-3 compliant logger with a built-in UI", 
            "title": "Working"
        }, 
        {
            "location": "/#not-yet-ported", 
            "text": "These modules exist for earlier Drupal versions, but have not been ported to\nDrupal 8 yet. Some of them might never be ported because they are no longer\nrelevant in Drupal 8     Module  Information      mongodb_block  Store Drupal blocks in MongoDB    mongodb_block_ui  Provide a UI to manager blocks stored in MongoDB. Depends on  mongodb_block .    mongodb_cache  Store cache information in MongoDB    mongodb_field_storage  Store entities and their fields in MongoDB    mongodb_migrate  Migrate SQL entities/fields to MongoDB. Depends on  mongodb_field_storage .    mongodb_queue  Implement a MongoDB backend for Queue API    mongodb_session  Store session information in MongoDB", 
            "title": "Not yet ported"
        }, 
        {
            "location": "/#planned", 
            "text": "These modules have no direct equivalent in earlier versions, but their\ndevelopment is being considered.     Module  Information      mongodb_debug  Provide low-level debug information. A D7 version exists on  mongodb_logger  but depends on the legacy  mongo  PHP extension. Futures versions will need the 1.4 version of the  mongodb  extension which implements the MongoDB APM specification.", 
            "title": "Planned"
        }, 
        {
            "location": "/#project-layout", 
            "text": "mkdocs.yml    # The configuration file.\ndocs/\n    index.md  # The documentation homepage.\n    ...       # Other markdown pages, images and other files.", 
            "title": "Project layout"
        }, 
        {
            "location": "/#legal-information", 
            "text": "This suite of modules is licensed under the General Public License, version 2 or later (GPL-2.0+).  MongoDB is a registered trademark of MongoDB Inc.  Drupal is a registered trademark of Dries Buytaert.", 
            "title": "Legal information"
        }, 
        {
            "location": "/modules/mongodb/", 
            "text": "Driver: \nmongodb\n\n\nThe \nmongodb\n module is the main module in the suite, providing a thin Drupal\nadapter for the standard MongoDB PHP library, in the form of two factory\nservices and a base test class.\n\n\nFactories\n\n\nThe basic idea of these factory services is to provide a way to create\ninstances of the standard \nClient\n and \nDatabase\n classes from a simple alias\nstring, taking all properties initialized during these creations from the\nDrupal standard \nSettings\n object.\n\n\nThis allows code to be unaware of the execution environment, referring to\ndatabase or client by a functional alias, while the specifics of accessing\nthe relevant \nmongod\n/\nmongos\n and database are left to per-environment\nsettings,\n\n\n\n\nDrupal\\mongodb\\DatabaseFactory\n : This is the recommended entry point for\n  most applications, returning a \nMongoDb\\Database\n from a simple alias string.\n\n\n__construct(ClientFactory $client_factory, Settings $settings)\n. This is\n  normally invoked by the container, to which the class is exposed as\n  \nmongodb.database_factory\n.\n\n\nget(string $alias): MongoDb\\Database\n; returns a \nDatabase\n instance\n  matching the value defined in Drupal settings for \n$alias\n.\n\n\n\n\n\n\nDrupal\\mongodb\\ClientFactory\n: This one may be needed for more complex\n  applications, e.g. those wishing to handle operations spanning connections\n  to multiple MongoDB replica sets/sharded clusters.\n\n\n__construct(Settings $settings)\n. This is normally invoked by the\n  container, to which the class is exposed as \nmongodb.client_factory\n.\n\n\nget(string $alias): MongoDb\\Client\n; returns a \nClient\n instance matching\n  the value defined in Drupal settings for \n$alias\n.\n\n\n\n\n\n\n\n\nTest base class\n\n\nThe module provides a \n\\Drupal\\mongodb\\Tests\\MongoDbTestBase\n extending core\nclass \nKernelTestBase\n. This allows modules to define their own integration\ntests using the module services, and taking advantage of running in a per-test\ndatabase. What it actually provides:\n\n\n\n\nTest instance properties:\n\n\n$this-\nuri\n contains a MongoDB URI suitable for connecting to a default\nclient, taken from the value of the \nMONGODB_URI\n variable is passed in the\nenvironment, on the PHPUnit command line, or in the \nphpunit.xml\n\nconfiguration file, this will be its value, otherwise it will be set to the\ntraditional MongoDB default instance: \nmongodb://localhost:27017\n.\n\n\n$this-\nsettings\n contains a test-specific instance of core \nSettings\n,\nlimited to the \nmongodb\n settings key. The default database in these\nsettings is a temporary database defined by the Simpletest prefix, allowing\nit to be used without interacting with the rest of the site, and dropped\nduring test teardown.\n\n\n\n\n\n\nConstants: in addition to the ones used by the \nmongodb\n tests, the base test\n  defines constants usable by child tests:\n\n\nCLIENT_TEST_ALIAS\n is the alias for the default MongoDB test client\n\n\nDB_DEFAULT_ALIAS\n is the alias for the default test database\n\n\n\n\n\n\nModules:\n\n\nThe test base enabled the \nmongodb\n modules, since all modules using MongoDB\nare expected to depend on it.\n\n\nModule tests will typically want their own module enabled, so they will need\nto add to \nstatic::$modules\n instead of redefining it, to avoid losing the\n\nmongodb\n module.\n\n\n\n\n\n\nsetUp()\n / \ntearDown()\n:\n\n\nTests need to invoke \nparent::setUp()\n near the top of their own \nsetUp()\n,\n  to have the test base define the properties before doing their own work.\n\n\nTests need to invoke \nparent::tearDown()\n near the end of their own\n  \ntearDown()\n - if any - to drop the default test database.\n\n\nTests needing non-default test databases need to extend \n$this-\nsettings\n\n  to add their own database alias after invoking \nparent::setUp()\n, and need\n  to drop that database during their own \ntearDown()\n. They can use\n  \n$this-\ngetTestDatabaseName($postfix)\n method to build a per-test\n  database name that will not collide with the default database.\n\n\n\n\n\n\n\n\nA complete example of how to write a test using that base class is given on the\n\ntests\n page.", 
            "title": "Driver: mongodb"
        }, 
        {
            "location": "/modules/mongodb/#driver-mongodb", 
            "text": "The  mongodb  module is the main module in the suite, providing a thin Drupal\nadapter for the standard MongoDB PHP library, in the form of two factory\nservices and a base test class.", 
            "title": "Driver: mongodb"
        }, 
        {
            "location": "/modules/mongodb/#factories", 
            "text": "The basic idea of these factory services is to provide a way to create\ninstances of the standard  Client  and  Database  classes from a simple alias\nstring, taking all properties initialized during these creations from the\nDrupal standard  Settings  object.  This allows code to be unaware of the execution environment, referring to\ndatabase or client by a functional alias, while the specifics of accessing\nthe relevant  mongod / mongos  and database are left to per-environment\nsettings,   Drupal\\mongodb\\DatabaseFactory  : This is the recommended entry point for\n  most applications, returning a  MongoDb\\Database  from a simple alias string.  __construct(ClientFactory $client_factory, Settings $settings) . This is\n  normally invoked by the container, to which the class is exposed as\n   mongodb.database_factory .  get(string $alias): MongoDb\\Database ; returns a  Database  instance\n  matching the value defined in Drupal settings for  $alias .    Drupal\\mongodb\\ClientFactory : This one may be needed for more complex\n  applications, e.g. those wishing to handle operations spanning connections\n  to multiple MongoDB replica sets/sharded clusters.  __construct(Settings $settings) . This is normally invoked by the\n  container, to which the class is exposed as  mongodb.client_factory .  get(string $alias): MongoDb\\Client ; returns a  Client  instance matching\n  the value defined in Drupal settings for  $alias .", 
            "title": "Factories"
        }, 
        {
            "location": "/modules/mongodb/#test-base-class", 
            "text": "The module provides a  \\Drupal\\mongodb\\Tests\\MongoDbTestBase  extending core\nclass  KernelTestBase . This allows modules to define their own integration\ntests using the module services, and taking advantage of running in a per-test\ndatabase. What it actually provides:   Test instance properties:  $this- uri  contains a MongoDB URI suitable for connecting to a default\nclient, taken from the value of the  MONGODB_URI  variable is passed in the\nenvironment, on the PHPUnit command line, or in the  phpunit.xml \nconfiguration file, this will be its value, otherwise it will be set to the\ntraditional MongoDB default instance:  mongodb://localhost:27017 .  $this- settings  contains a test-specific instance of core  Settings ,\nlimited to the  mongodb  settings key. The default database in these\nsettings is a temporary database defined by the Simpletest prefix, allowing\nit to be used without interacting with the rest of the site, and dropped\nduring test teardown.    Constants: in addition to the ones used by the  mongodb  tests, the base test\n  defines constants usable by child tests:  CLIENT_TEST_ALIAS  is the alias for the default MongoDB test client  DB_DEFAULT_ALIAS  is the alias for the default test database    Modules:  The test base enabled the  mongodb  modules, since all modules using MongoDB\nare expected to depend on it.  Module tests will typically want their own module enabled, so they will need\nto add to  static::$modules  instead of redefining it, to avoid losing the mongodb  module.    setUp()  /  tearDown() :  Tests need to invoke  parent::setUp()  near the top of their own  setUp() ,\n  to have the test base define the properties before doing their own work.  Tests need to invoke  parent::tearDown()  near the end of their own\n   tearDown()  - if any - to drop the default test database.  Tests needing non-default test databases need to extend  $this- settings \n  to add their own database alias after invoking  parent::setUp() , and need\n  to drop that database during their own  tearDown() . They can use\n   $this- getTestDatabaseName($postfix)  method to build a per-test\n  database name that will not collide with the default database.     A complete example of how to write a test using that base class is given on the tests  page.", 
            "title": "Test base class"
        }, 
        {
            "location": "/modules/mongodb_watchdog/", 
            "text": "Logger: \nmongodb_watchdog", 
            "title": "Logger: mongodb_watchdog"
        }, 
        {
            "location": "/modules/mongodb_watchdog/#logger-mongodb_watchdog", 
            "text": "", 
            "title": "Logger: mongodb_watchdog"
        }, 
        {
            "location": "/bespoke/", 
            "text": "Bespoke code\n\n\nBeyond the simple use cases covered by this standard package, most uses of\nMongoDB in Drupal projects appear in enteprise-class bespoke developments. Until\nthis version, this usually meant totally custom code, built either straight from\nthe legacy \nmongo\n extension, or on top of the Doctrine ODM for MongoDB,\nsuffering from a total lack of integration with the underlying core Drupal CMS.\n\n\nStarting with 8.x-2.0, such one-off code can be developed on top of the base\n\nmongodb\n module: unlike earlier releases, 8.x-2.x uses the PHP-standard\nconnection methods and options, without deviation, adding only a thin layer of\nDrupal adaptation on top of the standard \nmongodb\n \nextension\n and\n\nPHP library\n.\n\n\nExample\n\n\nThe familiar Drupal alias mechanism for databases is available to provide easy,\nstring-referenced access to \nClient\n and \nDatabase\n instances through the\npackage-provided \nClientFactory\n and \nDatabaseFactory\n services respectively.\n\n\nMost such code is likely to be service based, so here is an example of a service\n\nbar\n in module \nfoo\n, using a custom \nfoo-database\n aliased as \nfoodb\n, to keep\nits storage separate from the main database used by the package modules, and its\nlogic independent of other Drupal modules.\n\n\nPer-environment settings\n\n\nThe site local settings file includes the alias definition, binding it to the\nactual database credentials, allowing for per-environment configuration:\n\n\n?php\n// settings.local.php\n$settings['mongodb'] = [\n  'clients' =\n [\n    // Client alias =\n constructor parameters.\n    'default' =\n [\n      'uri' =\n 'mongodb://localhost:27017',\n      'uriOptions' =\n [],\n      'driverOptions' =\n [],\n    ],\n  ],\n  'databases' =\n [\n    // Collection alias =\n [ client_alias, collection_name ]\n    'default' =\n ['default', 'drupal'],\n    'logger' =\n ['default', 'logger'],\n    'foodb' =\n ['default', 'foo-database'],\n  ],\n];\n\n\n\nWith such a configuration, the \nfoodb\n alias is available to all MongoDB-using\nmodules in the site, possibly pointing to different databases depending on the\nenvironment (development, staging, production...).\n\n\nService-based module adapter\n\n\nThe \nfoo.services.yml\n service file for the bespoke \nfoo.module\n can then\nreference \nfoodb\n to access the database with a constant alias, regardless\nof the environment:\n\n\n// modules/custom/Foo/foo.services.yml\nservices:\n  foo.storage:\n    class: 'MongoDB\\Database'\n    factory: ['@mongodb.database_factory', 'get']\n    arguments: ['foodb']\n\n  foo.bar:\n    class: 'Drupal\\foo\\Bar'\n    arguments: ['@foo.storage', '$logger.channel.foo']\n\n\n\nThis allows services in the module to access the database in both function code\nfor Drupal hooks, and OO code for component-level logic without having to be\nenvironment-aware.\n\n\nIf the \nmongodb_watchdog\n module is enabled, the logger passed to the\napplication will be a standard PSR-3 logger writing to MongoDB without the\napplication having to know anything about it, but still providing a standard\nDrupal UI to examine the application logs.\n\n\nComponent logic\n\n\nFinally the component application logic can use the services without receiving\nany Drupal-specific dependency. In this example, we can simply assume the\nservice code is located within the module itself, for simplicity:\n\n\n?php\n// modules/custom/Foo/src/Bar.php\nuse MongoDb\\Database;\nuse Psr\\Log\\LoggerInterface;\n\npublic function __construct(Database $database, LoggerInterface $logger) {\n  $this-\ndatabase = $database;\n  $this-\nlogger = $logger;\n}\n\npublic function baz() {\n  // Perform some business logic using $this-\ndatabase.\n  // Log it using $this-\nlogger.\n}\n\n\n\nHaving the code only receive standard services (like a PSR-3 logger) or\n\nPHP library\n classes allows it to be written as an agnostic component that can\nbe brought in using Composer and shared with non-Drupal code. This is often\nuseful in bespoke projects, which tend to combine Drupal with other parts of the\napplication written in Laravel or Symfony standard edition, since the code has\nno Drupal-specific dependency.\n\n\nTests\n\n\nThe \nmongodb\n module provides a \nMongoDbTestBase\n base test class allowing\nkernel-based integration tests, as described on the \ntests\n page.", 
            "title": "Bespoke code"
        }, 
        {
            "location": "/bespoke/#bespoke-code", 
            "text": "Beyond the simple use cases covered by this standard package, most uses of\nMongoDB in Drupal projects appear in enteprise-class bespoke developments. Until\nthis version, this usually meant totally custom code, built either straight from\nthe legacy  mongo  extension, or on top of the Doctrine ODM for MongoDB,\nsuffering from a total lack of integration with the underlying core Drupal CMS.  Starting with 8.x-2.0, such one-off code can be developed on top of the base mongodb  module: unlike earlier releases, 8.x-2.x uses the PHP-standard\nconnection methods and options, without deviation, adding only a thin layer of\nDrupal adaptation on top of the standard  mongodb   extension  and PHP library .", 
            "title": "Bespoke code"
        }, 
        {
            "location": "/bespoke/#example", 
            "text": "The familiar Drupal alias mechanism for databases is available to provide easy,\nstring-referenced access to  Client  and  Database  instances through the\npackage-provided  ClientFactory  and  DatabaseFactory  services respectively.  Most such code is likely to be service based, so here is an example of a service bar  in module  foo , using a custom  foo-database  aliased as  foodb , to keep\nits storage separate from the main database used by the package modules, and its\nlogic independent of other Drupal modules.", 
            "title": "Example"
        }, 
        {
            "location": "/bespoke/#per-environment-settings", 
            "text": "The site local settings file includes the alias definition, binding it to the\nactual database credentials, allowing for per-environment configuration:  ?php\n// settings.local.php\n$settings['mongodb'] = [\n  'clients' =  [\n    // Client alias =  constructor parameters.\n    'default' =  [\n      'uri' =  'mongodb://localhost:27017',\n      'uriOptions' =  [],\n      'driverOptions' =  [],\n    ],\n  ],\n  'databases' =  [\n    // Collection alias =  [ client_alias, collection_name ]\n    'default' =  ['default', 'drupal'],\n    'logger' =  ['default', 'logger'],\n    'foodb' =  ['default', 'foo-database'],\n  ],\n];  With such a configuration, the  foodb  alias is available to all MongoDB-using\nmodules in the site, possibly pointing to different databases depending on the\nenvironment (development, staging, production...).", 
            "title": "Per-environment settings"
        }, 
        {
            "location": "/bespoke/#service-based-module-adapter", 
            "text": "The  foo.services.yml  service file for the bespoke  foo.module  can then\nreference  foodb  to access the database with a constant alias, regardless\nof the environment:  // modules/custom/Foo/foo.services.yml\nservices:\n  foo.storage:\n    class: 'MongoDB\\Database'\n    factory: ['@mongodb.database_factory', 'get']\n    arguments: ['foodb']\n\n  foo.bar:\n    class: 'Drupal\\foo\\Bar'\n    arguments: ['@foo.storage', '$logger.channel.foo']  This allows services in the module to access the database in both function code\nfor Drupal hooks, and OO code for component-level logic without having to be\nenvironment-aware.  If the  mongodb_watchdog  module is enabled, the logger passed to the\napplication will be a standard PSR-3 logger writing to MongoDB without the\napplication having to know anything about it, but still providing a standard\nDrupal UI to examine the application logs.", 
            "title": "Service-based module adapter"
        }, 
        {
            "location": "/bespoke/#component-logic", 
            "text": "Finally the component application logic can use the services without receiving\nany Drupal-specific dependency. In this example, we can simply assume the\nservice code is located within the module itself, for simplicity:  ?php\n// modules/custom/Foo/src/Bar.php\nuse MongoDb\\Database;\nuse Psr\\Log\\LoggerInterface;\n\npublic function __construct(Database $database, LoggerInterface $logger) {\n  $this- database = $database;\n  $this- logger = $logger;\n}\n\npublic function baz() {\n  // Perform some business logic using $this- database.\n  // Log it using $this- logger.\n}  Having the code only receive standard services (like a PSR-3 logger) or PHP library  classes allows it to be written as an agnostic component that can\nbe brought in using Composer and shared with non-Drupal code. This is often\nuseful in bespoke projects, which tend to combine Drupal with other parts of the\napplication written in Laravel or Symfony standard edition, since the code has\nno Drupal-specific dependency.", 
            "title": "Component logic"
        }, 
        {
            "location": "/bespoke/#tests", 
            "text": "The  mongodb  module provides a  MongoDbTestBase  base test class allowing\nkernel-based integration tests, as described on the  tests  page.", 
            "title": "Tests"
        }, 
        {
            "location": "/tests/", 
            "text": "The newly ported modules have some test coverage, which can be checked with\nPHPUnit.\n\n\nPHPUnit\n\n\nWriting custom tests\n\n\nThe \nmongodb\n module provides a \nDrupal\\mongodb\\Tests\\MongoDbTestBase\n base\nclass on which to build custom kernel tests for \nbespoke\n modules, as\nit provides a per-test database created during test \nsetUp()\n, and\ndropped during \ntearDown()\n.\n\n\nThe base class is documented on the \nmongodb\n documentation page.\n\n\nComplete test example\n\n\nThis example show how to write a test using a custom \nfoo\n database for the\neponymous module \nfoo\n, assuming individual tests do not drop the database\ninstance themselves.\n\n\n?php\n\nnamespace Drupal\\foo\\Tests;\n\nuse Drupal\\mongodb\\Tests\\MongoDbTestBase;\n\n/**\n * @coversDefaultClass \\Drupal\\foo\\Foo\n * @group foo\n */\nclass FooTest extends MongoDbTestBase {\n  const MODULE = 'foo';\n\n  /**\n   * The test database.\n   */\n  protected $database;\n\n  /**\n   * Add a custom alias to settings and instantiate a custom database.\n   */\n  public function setUp() {\n    parent::setUp();\n    $this-\nsettings['databases'][static::MODULE] = [\n      static::CLIENT_TEST_ALIAS,\n      $this-\ngetTestDatabaseName(static::MODULE),\n    ];\n    $this-\ndatabase = new DatabaseFactory(\n      new ClientFactory($this-\nsettings),\n      $this-\nsettings\n    )-\nget(static::MODULE);\n  }\n\n  /**\n   * Drop the custom database.\n   */\n  public function tearDown() {\n    $this-\ndatabase-\ndrop();\n    parent::tearDown();\n  }\n\n  /**\n   * @covers ::whatever\n   */\n  public function testWhatever() {\n    // ... custom test logic...\n  }\n\n}\n\n\n\nRunning tests\n\n\nWith the Simpletest UI apparently going away in Drupal 8.2 (cf \n#2566767\n,\n\n#2750461\n), tests should be run from the command line.\n\n\nRunning directly\n\n\nThe typical full command to run tests looks like this (\n\\\n is to avoid too long a line):\n\n\nMONGODB_URI=mongodb://somemongohost:27017 \\\nSIMPLETEST_DB=mysql://someuser:somepassword@localhost/somedatabase \\\nphpunit -c core/phpunit.xml.dist\n\n\n\n\n\nOptional: \nMONGODB_URI\n points to a working MongoDB instance. This variable is optional:\n  if it is not provided, the tests will default to \nmongodb://localhost:27017\n.\n\n\nRequired: \nSIMPLETEST_DB\n is the standard Drupal 8 variable needed to run tests that\n  can need the database service.\n\n\n\n\nBoth variables can be set in the \ncore/phpunit.xml\n custom configuration file.\n\n\nUsing a \nphpunit.xml\n configuration file\n\n\nThe test command can also be simplified using a \nphpunit.xml\n configuration file:\n\n\nphpunit -c core/phpunit.xml\n\n\n\nOr to generate a coverage report:\n\n\nphpunit -c core/phpunit.xml --coverage-html=/some/coverage/path modules/contrib/mongodb\n\n\n\n\n\ncore/phpunit.xml\n is a local copy of the default \ncore/phpunit.xml.dist\n\n  configuration file, tweaked to only test the minimum set of files needed by\n  the test suite.\n\n\nIt can look like this, to obtain a coverage report not including the whole\n  Drupal tree, but just the MongoDB package itself:\n?xml version=\"1.0\" encoding=\"UTF-8\"?\n\n\n\nphpunit ...snip...\n\n  \nphp\n\n    \nenv name=\"SIMPLETEST_DB\" value=\"mysql://someuser:somepass@somesqlhost/somedb\"/\n\n    \nenv name=\"MONGODB_URI\" value=\"mongodb://somemongohost:27017\" /\n\n  \n/php\n\n  \ntestsuites ...snip...\n...snip...\n/testsuites\n\n  \nlisteners\n...snip...\n/listener\n\n  \n/listeners\n\n  \nfilter\n\n    \nwhitelist\n\n      \ndirectory\n../modules/contrib/mongodb\n/directory\n\n      \nexclude\n\n        \ndirectory\n../modules/contrib/mongodb/modules/mongodb/src/Tests\n/directory\n\n        \ndirectory suffix=\"Test.php\"\n./\n/directory\n\n        \ndirectory suffix=\"TestBase.php\"\n./\n/directory\n\n      \n/exclude\n\n     \n/whitelist\n\n  \n/filter\n\n\n/phpunit", 
            "title": "Tests"
        }, 
        {
            "location": "/tests/#phpunit", 
            "text": "", 
            "title": "PHPUnit"
        }, 
        {
            "location": "/tests/#writing-custom-tests", 
            "text": "The  mongodb  module provides a  Drupal\\mongodb\\Tests\\MongoDbTestBase  base\nclass on which to build custom kernel tests for  bespoke  modules, as\nit provides a per-test database created during test  setUp() , and\ndropped during  tearDown() .  The base class is documented on the  mongodb  documentation page.", 
            "title": "Writing custom tests"
        }, 
        {
            "location": "/tests/#complete-test-example", 
            "text": "This example show how to write a test using a custom  foo  database for the\neponymous module  foo , assuming individual tests do not drop the database\ninstance themselves.  ?php\n\nnamespace Drupal\\foo\\Tests;\n\nuse Drupal\\mongodb\\Tests\\MongoDbTestBase;\n\n/**\n * @coversDefaultClass \\Drupal\\foo\\Foo\n * @group foo\n */\nclass FooTest extends MongoDbTestBase {\n  const MODULE = 'foo';\n\n  /**\n   * The test database.\n   */\n  protected $database;\n\n  /**\n   * Add a custom alias to settings and instantiate a custom database.\n   */\n  public function setUp() {\n    parent::setUp();\n    $this- settings['databases'][static::MODULE] = [\n      static::CLIENT_TEST_ALIAS,\n      $this- getTestDatabaseName(static::MODULE),\n    ];\n    $this- database = new DatabaseFactory(\n      new ClientFactory($this- settings),\n      $this- settings\n    )- get(static::MODULE);\n  }\n\n  /**\n   * Drop the custom database.\n   */\n  public function tearDown() {\n    $this- database- drop();\n    parent::tearDown();\n  }\n\n  /**\n   * @covers ::whatever\n   */\n  public function testWhatever() {\n    // ... custom test logic...\n  }\n\n}", 
            "title": "Complete test example"
        }, 
        {
            "location": "/tests/#running-tests", 
            "text": "With the Simpletest UI apparently going away in Drupal 8.2 (cf  #2566767 , #2750461 ), tests should be run from the command line.", 
            "title": "Running tests"
        }, 
        {
            "location": "/tests/#running-directly", 
            "text": "The typical full command to run tests looks like this ( \\  is to avoid too long a line):  MONGODB_URI=mongodb://somemongohost:27017 \\\nSIMPLETEST_DB=mysql://someuser:somepassword@localhost/somedatabase \\\nphpunit -c core/phpunit.xml.dist   Optional:  MONGODB_URI  points to a working MongoDB instance. This variable is optional:\n  if it is not provided, the tests will default to  mongodb://localhost:27017 .  Required:  SIMPLETEST_DB  is the standard Drupal 8 variable needed to run tests that\n  can need the database service.   Both variables can be set in the  core/phpunit.xml  custom configuration file.", 
            "title": "Running directly"
        }, 
        {
            "location": "/tests/#using-a-phpunitxml-configuration-file", 
            "text": "The test command can also be simplified using a  phpunit.xml  configuration file:  phpunit -c core/phpunit.xml  Or to generate a coverage report:  phpunit -c core/phpunit.xml --coverage-html=/some/coverage/path modules/contrib/mongodb   core/phpunit.xml  is a local copy of the default  core/phpunit.xml.dist \n  configuration file, tweaked to only test the minimum set of files needed by\n  the test suite.  It can look like this, to obtain a coverage report not including the whole\n  Drupal tree, but just the MongoDB package itself: ?xml version=\"1.0\" encoding=\"UTF-8\"?  phpunit ...snip... \n   php \n     env name=\"SIMPLETEST_DB\" value=\"mysql://someuser:somepass@somesqlhost/somedb\"/ \n     env name=\"MONGODB_URI\" value=\"mongodb://somemongohost:27017\" / \n   /php \n   testsuites ...snip... ...snip... /testsuites \n   listeners ...snip... /listener \n   /listeners \n   filter \n     whitelist \n       directory ../modules/contrib/mongodb /directory \n       exclude \n         directory ../modules/contrib/mongodb/modules/mongodb/src/Tests /directory \n         directory suffix=\"Test.php\" ./ /directory \n         directory suffix=\"TestBase.php\" ./ /directory \n       /exclude \n      /whitelist \n   /filter  /phpunit", 
            "title": "Using a phpunit.xml configuration file"
        }
    ]
}